[I 2026-01-10 16:42:50,408] A new study created in memory with name: pretrain_optuna_tokenized

======================================================================
Starting hyperparameter optimization
======================================================================
Study name: pretrain_optuna_tokenized
Number of trials: 50
Search epochs per trial: 2
Pruning: True
Data subset factor: 0.2
======================================================================

  0%|          | 0/50 [00:00<?, ?it/s]                                        0%|          | 0/50 [00:06<?, ?it/s]Best trial: 0. Best value: 3.64668:   0%|          | 0/50 [00:06<?, ?it/s]Best trial: 0. Best value: 3.64668:   2%|▏         | 1/50 [00:06<05:12,  6.39s/it]                                                                                  Best trial: 0. Best value: 3.64668:   2%|▏         | 1/50 [00:08<05:12,  6.39s/it]Best trial: 0. Best value: 3.64668:   2%|▏         | 1/50 [00:08<05:12,  6.39s/it]Best trial: 0. Best value: 3.64668:   4%|▍         | 2/50 [00:08<03:02,  3.81s/it]                                                                                  Best trial: 0. Best value: 3.64668:   4%|▍         | 2/50 [00:10<03:02,  3.81s/it]Best trial: 0. Best value: 3.64668:   4%|▍         | 2/50 [00:10<03:02,  3.81s/it]Best trial: 0. Best value: 3.64668:   6%|▌         | 3/50 [00:10<02:18,  2.95s/it]                                                                                  Best trial: 0. Best value: 3.64668:   6%|▌         | 3/50 [00:11<02:18,  2.95s/it]Best trial: 0. Best value: 3.64668:   6%|▌         | 3/50 [00:11<02:18,  2.95s/it]Best trial: 0. Best value: 3.64668:   8%|▊         | 4/50 [00:11<01:38,  2.13s/it]                                                                                  Best trial: 0. Best value: 3.64668:   8%|▊         | 4/50 [00:12<01:38,  2.13s/it]Best trial: 0. Best value: 3.64668:   8%|▊         | 4/50 [00:12<01:38,  2.13s/it]Best trial: 0. Best value: 3.64668:  10%|█         | 5/50 [00:12<01:29,  1.98s/it]                                                                                  Best trial: 0. Best value: 3.64668:  10%|█         | 5/50 [00:17<01:29,  1.98s/it]Best trial: 0. Best value: 3.64668:  10%|█         | 5/50 [00:17<01:29,  1.98s/it]Best trial: 0. Best value: 3.64668:  12%|█▏        | 6/50 [00:17<02:09,  2.94s/it]                                                                                  Best trial: 0. Best value: 3.64668:  12%|█▏        | 6/50 [00:19<02:09,  2.94s/it]Best trial: 0. Best value: 3.64668:  12%|█▏        | 6/50 [00:19<02:09,  2.94s/it]Best trial: 0. Best value: 3.64668:  14%|█▍        | 7/50 [00:19<01:53,  2.65s/it]                                                                                  Best trial: 0. Best value: 3.64668:  14%|█▍        | 7/50 [00:21<01:53,  2.65s/it]Best trial: 0. Best value: 3.64668:  14%|█▍        | 7/50 [00:21<01:53,  2.65s/it]Best trial: 0. Best value: 3.64668:  16%|█▌        | 8/50 [00:21<01:34,  2.25s/it]                                                                                  Best trial: 0. Best value: 3.64668:  16%|█▌        | 8/50 [00:24<01:34,  2.25s/it]Best trial: 0. Best value: 3.64668:  16%|█▌        | 8/50 [00:24<01:34,  2.25s/it]Best trial: 0. Best value: 3.64668:  18%|█▊        | 9/50 [00:24<01:45,  2.57s/it]                                                                                  Best trial: 0. Best value: 3.64668:  18%|█▊        | 9/50 [00:26<01:45,  2.57s/it]Best trial: 0. Best value: 3.64668:  18%|█▊        | 9/50 [00:26<01:45,  2.57s/it]Best trial: 0. Best value: 3.64668:  20%|██        | 10/50 [00:26<01:34,  2.37s/it]                                                                                   Best trial: 0. Best value: 3.64668:  20%|██        | 10/50 [00:33<01:34,  2.37s/it]Best trial: 10. Best value: 2.73884:  20%|██        | 10/50 [00:33<01:34,  2.37s/it]Best trial: 10. Best value: 2.73884:  22%|██▏       | 11/50 [00:33<02:25,  3.73s/it]                                                                                    Best trial: 10. Best value: 2.73884:  22%|██▏       | 11/50 [00:39<02:25,  3.73s/it]Best trial: 11. Best value: 2.73288:  22%|██▏       | 11/50 [00:39<02:25,  3.73s/it]Best trial: 11. Best value: 2.73288:  24%|██▍       | 12/50 [00:39<02:56,  4.65s/it]                                                                                    Best trial: 11. Best value: 2.73288:  24%|██▍       | 12/50 [00:46<02:56,  4.65s/it]Best trial: 12. Best value: 2.71324:  24%|██▍       | 12/50 [00:46<02:56,  4.65s/it]Best trial: 12. Best value: 2.71324:  26%|██▌       | 13/50 [00:46<03:16,  5.30s/it]                                                                                    Best trial: 12. Best value: 2.71324:  26%|██▌       | 13/50 [00:53<03:16,  5.30s/it]Best trial: 12. Best value: 2.71324:  26%|██▌       | 13/50 [00:53<03:16,  5.30s/it]Best trial: 12. Best value: 2.71324:  28%|██▊       | 14/50 [00:53<03:27,  5.75s/it]                                                                                    Best trial: 12. Best value: 2.71324:  28%|██▊       | 14/50 [00:59<03:27,  5.75s/it]Best trial: 12. Best value: 2.71324:  28%|██▊       | 14/50 [00:59<03:27,  5.75s/it]Best trial: 12. Best value: 2.71324:  30%|███       | 15/50 [00:59<03:26,  5.90s/it]                                                                                    Best trial: 12. Best value: 2.71324:  30%|███       | 15/50 [01:02<03:26,  5.90s/it]Best trial: 12. Best value: 2.71324:  30%|███       | 15/50 [01:02<03:26,  5.90s/it]Best trial: 12. Best value: 2.71324:  32%|███▏      | 16/50 [01:02<02:52,  5.08s/it]                                                                                    Best trial: 12. Best value: 2.71324:  32%|███▏      | 16/50 [01:08<02:52,  5.08s/it]Best trial: 12. Best value: 2.71324:  32%|███▏      | 16/50 [01:08<02:52,  5.08s/it]Best trial: 12. Best value: 2.71324:  34%|███▍      | 17/50 [01:08<02:53,  5.26s/it]                                                                                    Best trial: 12. Best value: 2.71324:  34%|███▍      | 17/50 [01:14<02:53,  5.26s/it]Best trial: 12. Best value: 2.71324:  34%|███▍      | 17/50 [01:14<02:53,  5.26s/it]Best trial: 12. Best value: 2.71324:  36%|███▌      | 18/50 [01:14<02:57,  5.56s/it]                                                                                    Best trial: 12. Best value: 2.71324:  36%|███▌      | 18/50 [01:18<02:57,  5.56s/it]Best trial: 12. Best value: 2.71324:  36%|███▌      | 18/50 [01:18<02:57,  5.56s/it]Best trial: 12. Best value: 2.71324:  38%|███▊      | 19/50 [01:18<02:37,  5.09s/it]                                                                                    Best trial: 12. Best value: 2.71324:  38%|███▊      | 19/50 [01:21<02:37,  5.09s/it]Best trial: 12. Best value: 2.71324:  38%|███▊      | 19/50 [01:21<02:37,  5.09s/it]Best trial: 12. Best value: 2.71324:  40%|████      | 20/50 [01:21<02:11,  4.40s/it]                                                                                    Best trial: 12. Best value: 2.71324:  40%|████      | 20/50 [01:28<02:11,  4.40s/it]Best trial: 12. Best value: 2.71324:  40%|████      | 20/50 [01:28<02:11,  4.40s/it]Best trial: 12. Best value: 2.71324:  42%|████▏     | 21/50 [01:28<02:28,  5.13s/it]                                                                                    [I 2026-01-10 16:42:56,795] Trial 0 finished with value: 3.6466848254203796 and parameters: {'lr': 5.6115164153345e-05, 'dropout': 0.2852142919229748, 'weight_decay': 0.000291063591313307, 'n_layers': 9, 'latent_size': 1024, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 3000, 'grad_clip': 1.097037220101252}. Best is trial 0 with value: 3.6466848254203796.
[I 2026-01-10 16:42:58,803] Trial 1 finished with value: 4.083629131317139 and parameters: {'lr': 7.309539835912905e-05, 'dropout': 0.08736874205941257, 'weight_decay': 0.00016738085788752134, 'n_layers': 5, 'latent_size': 1024, 'embedding_dim': 768, 'batch_size': 128, 'warmup_steps': 8000, 'grad_clip': 1.6359549614212763}. Best is trial 0 with value: 3.6466848254203796.
[I 2026-01-10 16:43:00,720] Trial 2 finished with value: 3.9345422983169556 and parameters: {'lr': 4.066563313514796e-05, 'dropout': 0.029301634201915158, 'weight_decay': 0.000233596350262616, 'n_layers': 7, 'latent_size': 1024, 'embedding_dim': 512, 'batch_size': 64, 'warmup_steps': 8000, 'grad_clip': 1.8001719658125328}. Best is trial 0 with value: 3.6466848254203796.
[I 2026-01-10 16:43:01,607] Trial 3 finished with value: 4.094481945037842 and parameters: {'lr': 0.0001569639638866114, 'dropout': 0.27656227050693505, 'weight_decay': 1.5030900645056805e-05, 'n_layers': 5, 'latent_size': 768, 'embedding_dim': 256, 'batch_size': 128, 'warmup_steps': 7000, 'grad_clip': 0.4775597949149275}. Best is trial 0 with value: 3.6466848254203796.
[I 2026-01-10 16:43:03,317] Trial 4 finished with value: 4.142522096633911 and parameters: {'lr': 1.0257563974185649e-05, 'dropout': 0.24463842853645024, 'weight_decay': 0.0002592475660475158, 'n_layers': 10, 'latent_size': 256, 'embedding_dim': 256, 'batch_size': 64, 'warmup_steps': 8000, 'grad_clip': 0.9972083578077036}. Best is trial 0 with value: 3.6466848254203796.
[I 2026-01-10 16:43:08,133] Trial 5 finished with value: 3.8292129039764404 and parameters: {'lr': 1.7345566642360933e-05, 'dropout': 0.21397343616689848, 'weight_decay': 0.0003323304206226791, 'n_layers': 9, 'latent_size': 256, 'embedding_dim': 1024, 'batch_size': 64, 'warmup_steps': 4000, 'grad_clip': 1.5355471632317925}. Best is trial 0 with value: 3.6466848254203796.
[I 2026-01-10 16:43:10,176] Trial 6 finished with value: 4.050121188163757 and parameters: {'lr': 2.8681134821030064e-05, 'dropout': 0.023093972948637898, 'weight_decay': 3.797544798678414e-05, 'n_layers': 5, 'latent_size': 256, 'embedding_dim': 768, 'batch_size': 32, 'warmup_steps': 2000, 'grad_clip': 0.911504798389887}. Best is trial 0 with value: 3.6466848254203796.
[I 2026-01-10 16:43:11,570] Trial 7 finished with value: 3.919073522090912 and parameters: {'lr': 0.0004325432427964555, 'dropout': 0.258219174976903, 'weight_decay': 1.0325337616482036e-05, 'n_layers': 8, 'latent_size': 256, 'embedding_dim': 256, 'batch_size': 32, 'warmup_steps': 4000, 'grad_clip': 0.6716687886518623}. Best is trial 0 with value: 3.6466848254203796.
[I 2026-01-10 16:43:14,845] Trial 8 finished with value: 4.015088856220245 and parameters: {'lr': 3.712624179040528e-05, 'dropout': 0.011066084206359838, 'weight_decay': 0.0001656260589333595, 'n_layers': 8, 'latent_size': 768, 'embedding_dim': 768, 'batch_size': 32, 'warmup_steps': 3000, 'grad_clip': 1.301381078127801}. Best is trial 0 with value: 3.6466848254203796.
[I 2026-01-10 16:43:16,750] Trial 9 finished with value: 4.018454074859619 and parameters: {'lr': 0.00018495216589727275, 'dropout': 0.16073240522242754, 'weight_decay': 1.5155823539597614e-05, 'n_layers': 11, 'latent_size': 1024, 'embedding_dim': 256, 'batch_size': 64, 'warmup_steps': 8000, 'grad_clip': 0.36128979387738713}. Best is trial 0 with value: 3.6466848254203796.
[I 2026-01-10 16:43:23,565] Trial 10 finished with value: 2.7388379871845245 and parameters: {'lr': 0.000776735381623706, 'dropout': 0.1676552694772402, 'weight_decay': 0.0008691089486124979, 'n_layers': 12, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.291078925322479}. Best is trial 10 with value: 2.7388379871845245.
[I 2026-01-10 16:43:30,340] Trial 11 finished with value: 2.732881098985672 and parameters: {'lr': 0.0009808126266739308, 'dropout': 0.18184389629895298, 'weight_decay': 0.0008589569128923666, 'n_layers': 12, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.2812360187852758}. Best is trial 11 with value: 2.732881098985672.
[I 2026-01-10 16:43:37,126] Trial 12 finished with value: 2.7132412493228912 and parameters: {'lr': 0.0008590989192880705, 'dropout': 0.1656078720226557, 'weight_decay': 0.00092396795676189, 'n_layers': 12, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.3210166590158243}. Best is trial 12 with value: 2.7132412493228912.
[I 2026-01-10 16:43:43,919] Trial 13 finished with value: 2.736698657274246 and parameters: {'lr': 0.0009818226878189125, 'dropout': 0.11245135338619613, 'weight_decay': 0.0009639122026050668, 'n_layers': 12, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.9901136950782061}. Best is trial 12 with value: 2.7132412493228912.
[I 2026-01-10 16:43:50,159] Trial 14 finished with value: 3.146098166704178 and parameters: {'lr': 0.00042344816912410344, 'dropout': 0.1992130739076912, 'weight_decay': 0.0005395066939232556, 'n_layers': 11, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 6000, 'grad_clip': 1.3231446092091776}. Best is trial 12 with value: 2.7132412493228912.
[I 2026-01-10 16:43:53,331] Trial 15 finished with value: 3.0098287761211395 and parameters: {'lr': 0.00042418486336435524, 'dropout': 0.12681169010257845, 'weight_decay': 7.203342330140873e-05, 'n_layers': 12, 'latent_size': 512, 'embedding_dim': 512, 'batch_size': 16, 'warmup_steps': 2000, 'grad_clip': 0.758066373290182}. Best is trial 12 with value: 2.7132412493228912.
[I 2026-01-10 16:43:59,026] Trial 16 finished with value: 2.861556261777878 and parameters: {'lr': 0.00020150194350382157, 'dropout': 0.20301515744300702, 'weight_decay': 0.0005498242173326432, 'n_layers': 10, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 0.1250405073237546}. Best is trial 12 with value: 2.7132412493228912.
[I 2026-01-10 16:44:05,276] Trial 17 finished with value: 2.8807797729969025 and parameters: {'lr': 0.0005963301181259485, 'dropout': 0.06670390707033828, 'weight_decay': 7.756193022802541e-05, 'n_layers': 11, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 5000, 'grad_clip': 1.5102274529584223}. Best is trial 12 with value: 2.7132412493228912.
[I 2026-01-10 16:44:09,283] Trial 18 finished with value: 3.011759042739868 and parameters: {'lr': 0.000288274137309685, 'dropout': 0.13979415009014953, 'weight_decay': 0.0005747529571418512, 'n_layers': 7, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 2000, 'grad_clip': 1.1555161310908333}. Best is trial 12 with value: 2.7132412493228912.
[I 2026-01-10 16:44:12,051] Trial 19 finished with value: 3.8394341468811035 and parameters: {'lr': 0.000973768934743161, 'dropout': 0.17837704815460978, 'weight_decay': 0.00042960619567114044, 'n_layers': 10, 'latent_size': 512, 'embedding_dim': 512, 'batch_size': 128, 'warmup_steps': 3000, 'grad_clip': 1.7496313080681052}. Best is trial 12 with value: 2.7132412493228912.
[I 2026-01-10 16:44:18,894] Trial 20 finished with value: 3.1958521902561188 and parameters: {'lr': 0.00028071801767531575, 'dropout': 0.23242653170167993, 'weight_decay': 0.0009827674611457352, 'n_layers': 12, 'latent_size': 768, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 5000, 'grad_clip': 0.8471078279118552}. Best is trial 12 with value: 2.7132412493228912.
[I 2026-01-10 16:44:25,716] Trial 21 finished with value: 2.674950271844864 and parameters: {'lr': 0.000946767331608165, 'dropout': 0.11050710991031507, 'weight_decay': 0.0006860816484011923, 'n_layers': 12, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.9288735817861549}. Best is trial 21 with value: 2.674950271844864.Best trial: 12. Best value: 2.71324:  42%|████▏     | 21/50 [01:35<02:28,  5.13s/it]Best trial: 21. Best value: 2.67495:  42%|████▏     | 21/50 [01:35<02:28,  5.13s/it]Best trial: 21. Best value: 2.67495:  44%|████▍     | 22/50 [01:35<02:37,  5.64s/it]                                                                                    Best trial: 21. Best value: 2.67495:  44%|████▍     | 22/50 [01:41<02:37,  5.64s/it]Best trial: 21. Best value: 2.67495:  44%|████▍     | 22/50 [01:41<02:37,  5.64s/it]Best trial: 21. Best value: 2.67495:  46%|████▌     | 23/50 [01:41<02:37,  5.82s/it]                                                                                    Best trial: 21. Best value: 2.67495:  46%|████▌     | 23/50 [01:48<02:37,  5.82s/it]Best trial: 21. Best value: 2.67495:  46%|████▌     | 23/50 [01:48<02:37,  5.82s/it]Best trial: 21. Best value: 2.67495:  48%|████▊     | 24/50 [01:48<02:39,  6.12s/it]                                                                                    Best trial: 21. Best value: 2.67495:  48%|████▊     | 24/50 [01:54<02:39,  6.12s/it]Best trial: 21. Best value: 2.67495:  48%|████▊     | 24/50 [01:54<02:39,  6.12s/it]Best trial: 21. Best value: 2.67495:  50%|█████     | 25/50 [01:54<02:34,  6.16s/it]                                                                                    Best trial: 21. Best value: 2.67495:  50%|█████     | 25/50 [01:56<02:34,  6.16s/it]Best trial: 21. Best value: 2.67495:  50%|█████     | 25/50 [01:56<02:34,  6.16s/it]Best trial: 21. Best value: 2.67495:  52%|█████▏    | 26/50 [01:56<02:00,  5.01s/it]                                                                                    Best trial: 21. Best value: 2.67495:  52%|█████▏    | 26/50 [02:02<02:00,  5.01s/it]Best trial: 21. Best value: 2.67495:  52%|█████▏    | 26/50 [02:02<02:00,  5.01s/it]Best trial: 21. Best value: 2.67495:  54%|█████▍    | 27/50 [02:02<01:59,  5.22s/it]                                                                                    Best trial: 21. Best value: 2.67495:  54%|█████▍    | 27/50 [02:06<01:59,  5.22s/it]Best trial: 21. Best value: 2.67495:  54%|█████▍    | 27/50 [02:06<01:59,  5.22s/it]Best trial: 21. Best value: 2.67495:  56%|█████▌    | 28/50 [02:06<01:43,  4.72s/it]                                                                                    Best trial: 21. Best value: 2.67495:  56%|█████▌    | 28/50 [02:09<01:43,  4.72s/it]Best trial: 21. Best value: 2.67495:  56%|█████▌    | 28/50 [02:09<01:43,  4.72s/it]Best trial: 21. Best value: 2.67495:  58%|█████▊    | 29/50 [02:09<01:30,  4.30s/it]                                                                                    Best trial: 21. Best value: 2.67495:  58%|█████▊    | 29/50 [02:15<01:30,  4.30s/it]Best trial: 21. Best value: 2.67495:  58%|█████▊    | 29/50 [02:15<01:30,  4.30s/it]Best trial: 21. Best value: 2.67495:  60%|██████    | 30/50 [02:15<01:38,  4.90s/it]                                                                                    Best trial: 21. Best value: 2.67495:  60%|██████    | 30/50 [02:20<01:38,  4.90s/it]Best trial: 21. Best value: 2.67495:  60%|██████    | 30/50 [02:20<01:38,  4.90s/it]Best trial: 21. Best value: 2.67495:  62%|██████▏   | 31/50 [02:20<01:34,  4.97s/it]                                                                                    Best trial: 21. Best value: 2.67495:  62%|██████▏   | 31/50 [02:27<01:34,  4.97s/it]Best trial: 21. Best value: 2.67495:  62%|██████▏   | 31/50 [02:27<01:34,  4.97s/it]Best trial: 21. Best value: 2.67495:  64%|██████▍   | 32/50 [02:27<01:39,  5.52s/it]                                                                                    Best trial: 21. Best value: 2.67495:  64%|██████▍   | 32/50 [02:34<01:39,  5.52s/it]Best trial: 21. Best value: 2.67495:  64%|██████▍   | 32/50 [02:34<01:39,  5.52s/it]Best trial: 21. Best value: 2.67495:  66%|██████▌   | 33/50 [02:34<01:40,  5.91s/it]                                                                                    Best trial: 21. Best value: 2.67495:  66%|██████▌   | 33/50 [02:40<01:40,  5.91s/it]Best trial: 21. Best value: 2.67495:  66%|██████▌   | 33/50 [02:40<01:40,  5.91s/it]Best trial: 21. Best value: 2.67495:  68%|██████▊   | 34/50 [02:40<01:36,  6.01s/it]                                                                                    Best trial: 21. Best value: 2.67495:  68%|██████▊   | 34/50 [02:47<01:36,  6.01s/it]Best trial: 21. Best value: 2.67495:  68%|██████▊   | 34/50 [02:47<01:36,  6.01s/it]Best trial: 21. Best value: 2.67495:  70%|███████   | 35/50 [02:47<01:31,  6.12s/it]                                                                                    Best trial: 21. Best value: 2.67495:  70%|███████   | 35/50 [02:51<01:31,  6.12s/it]Best trial: 21. Best value: 2.67495:  70%|███████   | 35/50 [02:51<01:31,  6.12s/it]Best trial: 21. Best value: 2.67495:  72%|███████▏  | 36/50 [02:51<01:16,  5.48s/it]                                                                                    Best trial: 21. Best value: 2.67495:  72%|███████▏  | 36/50 [02:52<01:16,  5.48s/it]Best trial: 21. Best value: 2.67495:  72%|███████▏  | 36/50 [02:52<01:16,  5.48s/it]Best trial: 21. Best value: 2.67495:  74%|███████▍  | 37/50 [02:52<00:53,  4.15s/it]                                                                                    Best trial: 21. Best value: 2.67495:  74%|███████▍  | 37/50 [02:55<00:53,  4.15s/it]Best trial: 21. Best value: 2.67495:  74%|███████▍  | 37/50 [02:55<00:53,  4.15s/it]Best trial: 21. Best value: 2.67495:  76%|███████▌  | 38/50 [02:55<00:45,  3.78s/it]                                                                                    Best trial: 21. Best value: 2.67495:  76%|███████▌  | 38/50 [03:01<00:45,  3.78s/it]Best trial: 21. Best value: 2.67495:  76%|███████▌  | 38/50 [03:01<00:45,  3.78s/it]Best trial: 21. Best value: 2.67495:  78%|███████▊  | 39/50 [03:01<00:50,  4.60s/it]                                                                                    Best trial: 21. Best value: 2.67495:  78%|███████▊  | 39/50 [03:07<00:50,  4.60s/it]Best trial: 21. Best value: 2.67495:  78%|███████▊  | 39/50 [03:07<00:50,  4.60s/it]Best trial: 21. Best value: 2.67495:  80%|████████  | 40/50 [03:07<00:49,  4.92s/it]                                                                                    Best trial: 21. Best value: 2.67495:  80%|████████  | 40/50 [03:08<00:49,  4.92s/it]Best trial: 21. Best value: 2.67495:  80%|████████  | 40/50 [03:08<00:49,  4.92s/it]Best trial: 21. Best value: 2.67495:  82%|████████▏ | 41/50 [03:08<00:34,  3.82s/it]                                                                                    Best trial: 21. Best value: 2.67495:  82%|████████▏ | 41/50 [03:15<00:34,  3.82s/it]Best trial: 21. Best value: 2.67495:  82%|████████▏ | 41/50 [03:15<00:34,  3.82s/it]Best trial: 21. Best value: 2.67495:  84%|████████▍ | 42/50 [03:15<00:37,  4.72s/it]                                                                                    Best trial: 21. Best value: 2.67495:  84%|████████▍ | 42/50 [03:22<00:37,  4.72s/it]Best trial: 21. Best value: 2.67495:  84%|████████▍ | 42/50 [03:22<00:37,  4.72s/it]Best trial: 21. Best value: 2.67495:  86%|████████▌ | 43/50 [03:22<00:37,  5.35s/it]                                                                                    
[I 2026-01-10 16:44:31,974] Trial 22 finished with value: 2.757880389690399 and parameters: {'lr': 0.0006130467200654347, 'dropout': 0.10082825738092487, 'weight_decay': 0.0007476056486803587, 'n_layers': 11, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.9437216293134298}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:44:38,794] Trial 23 finished with value: 2.7888651192188263 and parameters: {'lr': 0.0006102004765634808, 'dropout': 0.059112998596112826, 'weight_decay': 0.0004232932654547445, 'n_layers': 12, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 2000, 'grad_clip': 1.442427988632831}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:44:45,051] Trial 24 finished with value: 2.936165064573288 and parameters: {'lr': 0.00012569357673101228, 'dropout': 0.14618160297949528, 'weight_decay': 0.0006849214216927835, 'n_layers': 11, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.673624036273075}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:44:47,374] Trial 25 finished with value: 3.046924263238907 and parameters: {'lr': 0.0003133244195123924, 'dropout': 0.17764498033124204, 'weight_decay': 0.00041936040834955444, 'n_layers': 4, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 2000, 'grad_clip': 1.1855275510012488}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:44:53,066] Trial 26 finished with value: 2.812199115753174 and parameters: {'lr': 0.0007547907043156492, 'dropout': 0.12462973643293725, 'weight_decay': 0.00011280483243627007, 'n_layers': 10, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 3000, 'grad_clip': 1.8822889724285943}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:44:56,622] Trial 27 finished with value: 3.685863733291626 and parameters: {'lr': 0.0009849718098056235, 'dropout': 0.0806498560369546, 'weight_decay': 0.0006683341303577251, 'n_layers': 9, 'latent_size': 512, 'embedding_dim': 768, 'batch_size': 128, 'warmup_steps': 1000, 'grad_clip': 1.3841743858104674}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:44:59,960] Trial 28 finished with value: 3.463974118232727 and parameters: {'lr': 0.0004735573368539057, 'dropout': 0.18673631396730223, 'weight_decay': 5.03557301592008e-05, 'n_layers': 12, 'latent_size': 768, 'embedding_dim': 512, 'batch_size': 32, 'warmup_steps': 2000, 'grad_clip': 1.6378263692533859}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:45:06,263] Trial 29 finished with value: 3.5201480388641357 and parameters: {'lr': 9.149289811282793e-05, 'dropout': 0.22306583379828857, 'weight_decay': 0.00019160390278476685, 'n_layers': 11, 'latent_size': 1024, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 4000, 'grad_clip': 1.1107070050046746}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:45:11,392] Trial 30 finished with value: 2.829413741827011 and parameters: {'lr': 0.0007004609738345306, 'dropout': 0.15047934755430994, 'weight_decay': 0.0003292103526290187, 'n_layers': 9, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 3000, 'grad_clip': 0.9823139668486933}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:45:18,206] Trial 31 finished with value: 2.7276414930820465 and parameters: {'lr': 0.000985832630232926, 'dropout': 0.11099951113660225, 'weight_decay': 0.0009557510436433413, 'n_layers': 12, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.916134100475223}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:45:25,014] Trial 32 finished with value: 2.7419602274894714 and parameters: {'lr': 0.0005248759865056022, 'dropout': 0.09971774519762018, 'weight_decay': 0.0007964720390569466, 'n_layers': 12, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.784946089553669}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:45:31,266] Trial 33 finished with value: 2.784424662590027 and parameters: {'lr': 0.0007806869903762579, 'dropout': 0.046600068851495244, 'weight_decay': 0.0005077373310497264, 'n_layers': 11, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 2000, 'grad_clip': 1.5581369478687315}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:45:37,631] Trial 34 finished with value: 3.809379816055298 and parameters: {'lr': 0.00034653135882025044, 'dropout': 0.2979716059159515, 'weight_decay': 0.0007248734872276724, 'n_layers': 12, 'latent_size': 1024, 'embedding_dim': 1024, 'batch_size': 128, 'warmup_steps': 1000, 'grad_clip': 1.826649379823464}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:45:41,616] Trial 35 finished with value: 2.800744980573654 and parameters: {'lr': 0.0009677373075448534, 'dropout': 0.12437175764646155, 'weight_decay': 0.00035824233904496977, 'n_layers': 10, 'latent_size': 512, 'embedding_dim': 768, 'batch_size': 16, 'warmup_steps': 2000, 'grad_clip': 1.721433417453536}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:45:42,670] Trial 36 finished with value: 3.897580146789551 and parameters: {'lr': 0.0007204898571631096, 'dropout': 0.08403030082755782, 'weight_decay': 0.0009244985697538216, 'n_layers': 6, 'latent_size': 512, 'embedding_dim': 256, 'batch_size': 64, 'warmup_steps': 1000, 'grad_clip': 1.9988392819362626}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:45:45,581] Trial 37 finished with value: 3.85851389169693 and parameters: {'lr': 5.7534056640730004e-05, 'dropout': 0.1583898929940386, 'weight_decay': 0.00021804331349321588, 'n_layers': 11, 'latent_size': 256, 'embedding_dim': 512, 'batch_size': 16, 'warmup_steps': 3000, 'grad_clip': 1.5634736837932641}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:45:52,098] Trial 38 finished with value: 3.259027123451233 and parameters: {'lr': 0.0005192563049941977, 'dropout': 0.13771354201888375, 'weight_decay': 0.0002708885509972567, 'n_layers': 12, 'latent_size': 768, 'embedding_dim': 1024, 'batch_size': 64, 'warmup_steps': 1000, 'grad_clip': 1.2176474312907142}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:45:57,761] Trial 39 finished with value: 3.2274858355522156 and parameters: {'lr': 0.00036135779812960454, 'dropout': 0.10837044500370209, 'weight_decay': 0.0006142287106105012, 'n_layers': 10, 'latent_size': 1024, 'embedding_dim': 1024, 'batch_size': 32, 'warmup_steps': 2000, 'grad_clip': 1.8850689803330436}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:45:59,000] Trial 40 finished with value: 4.090224266052246 and parameters: {'lr': 0.00023575982513350557, 'dropout': 0.2518438134338528, 'weight_decay': 0.0001497936291494011, 'n_layers': 7, 'latent_size': 256, 'embedding_dim': 256, 'batch_size': 128, 'warmup_steps': 7000, 'grad_clip': 1.0619805990546096}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:46:05,827] Trial 41 finished with value: 2.7244615256786346 and parameters: {'lr': 0.0009431293990308473, 'dropout': 0.10910762063200126, 'weight_decay': 0.0009397206897718342, 'n_layers': 12, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.9715791651607601}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:46:12,656] Trial 42 finished with value: 2.6790196299552917 and parameters: {'lr': 0.000824387060163908, 'dropout': 0.0716044271741759, 'weight_decay': 0.0009976960768755684, 'n_layers': 12, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.868239612393118}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:46:18,922] Trial 43 finished with value: 2.684446781873703 and parameters: {'lr': 0.0007687491968927109, 'dropout': 0.04515150913179691, 'weight_decay': 0.000489184033072682, 'n_layers': 11, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.8826815442404707}. Best is trial 21 with value: 2.674950271844864.Best trial: 21. Best value: 2.67495:  86%|████████▌ | 43/50 [03:28<00:37,  5.35s/it]Best trial: 21. Best value: 2.67495:  86%|████████▌ | 43/50 [03:28<00:37,  5.35s/it]Best trial: 21. Best value: 2.67495:  88%|████████▊ | 44/50 [03:28<00:33,  5.63s/it]                                                                                    Best trial: 21. Best value: 2.67495:  88%|████████▊ | 44/50 [03:32<00:33,  5.63s/it]Best trial: 21. Best value: 2.67495:  88%|████████▊ | 44/50 [03:32<00:33,  5.63s/it]Best trial: 21. Best value: 2.67495:  90%|█████████ | 45/50 [03:32<00:26,  5.25s/it]                                                                                    Best trial: 21. Best value: 2.67495:  90%|█████████ | 45/50 [03:39<00:26,  5.25s/it]Best trial: 21. Best value: 2.67495:  90%|█████████ | 45/50 [03:39<00:26,  5.25s/it]Best trial: 21. Best value: 2.67495:  92%|█████████▏| 46/50 [03:39<00:22,  5.56s/it]                                                                                    Best trial: 21. Best value: 2.67495:  92%|█████████▏| 46/50 [03:45<00:22,  5.56s/it]Best trial: 21. Best value: 2.67495:  92%|█████████▏| 46/50 [03:45<00:22,  5.56s/it]Best trial: 21. Best value: 2.67495:  94%|█████████▍| 47/50 [03:45<00:17,  5.86s/it]                                                                                    Best trial: 21. Best value: 2.67495:  94%|█████████▍| 47/50 [03:47<00:17,  5.86s/it]Best trial: 21. Best value: 2.67495:  94%|█████████▍| 47/50 [03:47<00:17,  5.86s/it]Best trial: 21. Best value: 2.67495:  96%|█████████▌| 48/50 [03:47<00:09,  4.66s/it]                                                                                    Best trial: 21. Best value: 2.67495:  96%|█████████▌| 48/50 [03:53<00:09,  4.66s/it]Best trial: 21. Best value: 2.67495:  96%|█████████▌| 48/50 [03:53<00:09,  4.66s/it]Best trial: 21. Best value: 2.67495:  98%|█████████▊| 49/50 [03:53<00:05,  5.11s/it]                                                                                    Best trial: 21. Best value: 2.67495:  98%|█████████▊| 49/50 [04:00<00:05,  5.11s/it]Best trial: 21. Best value: 2.67495:  98%|█████████▊| 49/50 [04:00<00:05,  5.11s/it]Best trial: 21. Best value: 2.67495: 100%|██████████| 50/50 [04:00<00:00,  5.63s/it]Best trial: 21. Best value: 2.67495: 100%|██████████| 50/50 [04:00<00:00,  4.81s/it]

[I 2026-01-10 16:46:23,297] Trial 44 finished with value: 2.768933892250061 and parameters: {'lr': 0.0007273851271642227, 'dropout': 0.04597090968415919, 'weight_decay': 0.000495826437118448, 'n_layers': 11, 'latent_size': 512, 'embedding_dim': 768, 'batch_size': 16, 'warmup_steps': 2000, 'grad_clip': 1.825575705868496}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:46:29,563] Trial 45 finished with value: 3.605345696210861 and parameters: {'lr': 2.1535907879293594e-05, 'dropout': 0.029048492180517273, 'weight_decay': 2.4791113554241033e-05, 'n_layers': 11, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.704434416648415}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:46:36,121] Trial 46 finished with value: 3.4742789268493652 and parameters: {'lr': 0.0005785784900760414, 'dropout': 0.003969883455866886, 'weight_decay': 0.0007398224454947307, 'n_layers': 12, 'latent_size': 256, 'embedding_dim': 1024, 'batch_size': 64, 'warmup_steps': 2000, 'grad_clip': 1.8407903243611776}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:46:37,975] Trial 47 finished with value: 3.9788274466991425 and parameters: {'lr': 1.2474550514326406e-05, 'dropout': 0.06337172870088746, 'weight_decay': 0.0003814705919528453, 'n_layers': 12, 'latent_size': 512, 'embedding_dim': 256, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.6047258717987634}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:46:44,150] Trial 48 finished with value: 2.938782513141632 and parameters: {'lr': 0.00040662235130681115, 'dropout': 0.07589406784664032, 'weight_decay': 0.0006351331123197081, 'n_layers': 11, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 32, 'warmup_steps': 1000, 'grad_clip': 1.4535915599729878}. Best is trial 21 with value: 2.674950271844864.
[I 2026-01-10 16:46:50,992] Trial 49 finished with value: 2.750303864479065 and parameters: {'lr': 0.0008317537281336823, 'dropout': 0.05110438211200102, 'weight_decay': 0.0003037266389995228, 'n_layers': 12, 'latent_size': 768, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 2000, 'grad_clip': 1.984923622633388}. Best is trial 21 with value: 2.674950271844864.

======================================================================
OPTIMIZATION COMPLETE
======================================================================
Number of finished trials: 50
Number of pruned trials: 0
Number of complete trials: 50

Best trial:
  Value (val_loss): 2.6750
  Params:
    lr: 0.000946767331608165
    dropout: 0.11050710991031507
    weight_decay: 0.0006860816484011923
    n_layers: 12
    latent_size: 512
    embedding_dim: 1024
    batch_size: 16
    warmup_steps: 1000
    grad_clip: 1.9288735817861549

Saved best hyperparameters to checkpoints/hyperparameter_search/best_hyperparameters.json
Saved parameter importance plot to checkpoints/hyperparameter_search/param_importance.html
Saved optimization history to checkpoints/hyperparameter_search/optimization_history.html

======================================================================
RECOMMENDATION:
======================================================================
Now train with best hyperparameters using:
  python pretrain_encoder.py --data_dir data/chembl/tokenized \
    --lr 0.000946767331608165 \
    --dropout 0.11050710991031507 \
    --weight_decay 0.0006860816484011923 \
    --n_layers 12 \
    --latent_size 512 \
    --embedding_dim 1024 \
    --batch_size 16 \
    --warmup_steps 1000 \
    --grad_clip 1.9288735817861549 \
    --epochs 10
======================================================================

