[I 2026-01-10 16:55:35,412] A new study created in memory with name: pretrain_optuna_tokenized

======================================================================
Starting hyperparameter optimization
======================================================================
Study name: pretrain_optuna_tokenized
Number of trials: 50
Search epochs per trial: 2
Pruning: True
Data subset factor: 0.2
======================================================================

  0%|          | 0/50 [00:00<?, ?it/s]                                        0%|          | 0/50 [00:30<?, ?it/s]Best trial: 0. Best value: 2.63751:   0%|          | 0/50 [00:30<?, ?it/s]Best trial: 0. Best value: 2.63751:   2%|▏         | 1/50 [00:30<24:43, 30.29s/it]                                                                                  Best trial: 0. Best value: 2.63751:   2%|▏         | 1/50 [00:41<24:43, 30.29s/it]Best trial: 0. Best value: 2.63751:   2%|▏         | 1/50 [00:41<24:43, 30.29s/it]Best trial: 0. Best value: 2.63751:   4%|▍         | 2/50 [00:41<15:25, 19.29s/it]                                                                                  Best trial: 0. Best value: 2.63751:   4%|▍         | 2/50 [00:53<15:25, 19.29s/it]Best trial: 0. Best value: 2.63751:   4%|▍         | 2/50 [00:53<15:25, 19.29s/it]Best trial: 0. Best value: 2.63751:   6%|▌         | 3/50 [00:53<12:18, 15.72s/it]                                                                                  Best trial: 0. Best value: 2.63751:   6%|▌         | 3/50 [00:58<12:18, 15.72s/it]Best trial: 0. Best value: 2.63751:   6%|▌         | 3/50 [00:58<12:18, 15.72s/it]Best trial: 0. Best value: 2.63751:   8%|▊         | 4/50 [00:58<08:58, 11.70s/it]                                                                                  Best trial: 0. Best value: 2.63751:   8%|▊         | 4/50 [01:09<08:58, 11.70s/it]Best trial: 0. Best value: 2.63751:   8%|▊         | 4/50 [01:09<08:58, 11.70s/it]Best trial: 0. Best value: 2.63751:  10%|█         | 5/50 [01:09<08:30, 11.35s/it]                                                                                  Best trial: 0. Best value: 2.63751:  10%|█         | 5/50 [01:37<08:30, 11.35s/it]Best trial: 0. Best value: 2.63751:  10%|█         | 5/50 [01:37<08:30, 11.35s/it]Best trial: 0. Best value: 2.63751:  12%|█▏        | 6/50 [01:37<12:27, 16.98s/it]                                                                                  Best trial: 0. Best value: 2.63751:  12%|█▏        | 6/50 [01:49<12:27, 16.98s/it]Best trial: 0. Best value: 2.63751:  12%|█▏        | 6/50 [01:49<12:27, 16.98s/it]Best trial: 0. Best value: 2.63751:  14%|█▍        | 7/50 [01:49<10:57, 15.29s/it]                                                                                  Best trial: 0. Best value: 2.63751:  14%|█▍        | 7/50 [01:57<10:57, 15.29s/it]Best trial: 0. Best value: 2.63751:  14%|█▍        | 7/50 [01:57<10:57, 15.29s/it]Best trial: 0. Best value: 2.63751:  16%|█▌        | 8/50 [01:57<09:09, 13.08s/it]                                                                                  Best trial: 0. Best value: 2.63751:  16%|█▌        | 8/50 [02:16<09:09, 13.08s/it]Best trial: 0. Best value: 2.63751:  16%|█▌        | 8/50 [02:16<09:09, 13.08s/it]Best trial: 0. Best value: 2.63751:  18%|█▊        | 9/50 [02:16<10:10, 14.89s/it]                                                                                  Best trial: 0. Best value: 2.63751:  18%|█▊        | 9/50 [02:28<10:10, 14.89s/it]Best trial: 0. Best value: 2.63751:  18%|█▊        | 9/50 [02:28<10:10, 14.89s/it]Best trial: 0. Best value: 2.63751:  20%|██        | 10/50 [02:28<09:18, 13.96s/it]                                                                                   Best trial: 0. Best value: 2.63751:  20%|██        | 10/50 [03:07<09:18, 13.96s/it]Best trial: 10. Best value: 2.30772:  20%|██        | 10/50 [03:07<09:18, 13.96s/it]Best trial: 10. Best value: 2.30772:  22%|██▏       | 11/50 [03:07<14:01, 21.58s/it]                                                                                    Best trial: 10. Best value: 2.30772:  22%|██▏       | 11/50 [03:46<14:01, 21.58s/it]Best trial: 11. Best value: 2.27402:  22%|██▏       | 11/50 [03:46<14:01, 21.58s/it]Best trial: 11. Best value: 2.27402:  24%|██▍       | 12/50 [03:46<16:59, 26.84s/it]                                                                                    Best trial: 11. Best value: 2.27402:  24%|██▍       | 12/50 [04:25<16:59, 26.84s/it]Best trial: 11. Best value: 2.27402:  24%|██▍       | 12/50 [04:25<16:59, 26.84s/it]Best trial: 11. Best value: 2.27402:  26%|██▌       | 13/50 [04:25<18:48, 30.49s/it]                                                                                    Best trial: 11. Best value: 2.27402:  26%|██▌       | 13/50 [05:03<18:48, 30.49s/it]Best trial: 11. Best value: 2.27402:  26%|██▌       | 13/50 [05:03<18:48, 30.49s/it]Best trial: 11. Best value: 2.27402:  28%|██▊       | 14/50 [05:03<19:48, 33.03s/it]                                                                                    Best trial: 11. Best value: 2.27402:  28%|██▊       | 14/50 [05:39<19:48, 33.03s/it]Best trial: 11. Best value: 2.27402:  28%|██▊       | 14/50 [05:39<19:48, 33.03s/it]Best trial: 11. Best value: 2.27402:  30%|███       | 15/50 [05:39<19:43, 33.82s/it]                                                                                    Best trial: 11. Best value: 2.27402:  30%|███       | 15/50 [05:57<19:43, 33.82s/it]Best trial: 11. Best value: 2.27402:  30%|███       | 15/50 [05:57<19:43, 33.82s/it]Best trial: 11. Best value: 2.27402:  32%|███▏      | 16/50 [05:57<16:31, 29.17s/it]                                                                                    Best trial: 11. Best value: 2.27402:  32%|███▏      | 16/50 [06:30<16:31, 29.17s/it]Best trial: 11. Best value: 2.27402:  32%|███▏      | 16/50 [06:30<16:31, 29.17s/it]Best trial: 11. Best value: 2.27402:  34%|███▍      | 17/50 [06:30<16:35, 30.16s/it]                                                                                    Best trial: 11. Best value: 2.27402:  34%|███▍      | 17/50 [07:06<16:35, 30.16s/it]Best trial: 11. Best value: 2.27402:  34%|███▍      | 17/50 [07:06<16:35, 30.16s/it]Best trial: 11. Best value: 2.27402:  36%|███▌      | 18/50 [07:06<16:57, 31.81s/it]                                                                                    Best trial: 11. Best value: 2.27402:  36%|███▌      | 18/50 [07:28<16:57, 31.81s/it]Best trial: 11. Best value: 2.27402:  36%|███▌      | 18/50 [07:28<16:57, 31.81s/it]Best trial: 11. Best value: 2.27402:  38%|███▊      | 19/50 [07:28<15:02, 29.11s/it]                                                                                    Best trial: 11. Best value: 2.27402:  38%|███▊      | 19/50 [07:45<15:02, 29.11s/it]Best trial: 11. Best value: 2.27402:  38%|███▊      | 19/50 [07:45<15:02, 29.11s/it]Best trial: 11. Best value: 2.27402:  40%|████      | 20/50 [07:45<12:39, 25.30s/it]                                                                                    Best trial: 11. Best value: 2.27402:  40%|████      | 20/50 [08:24<12:39, 25.30s/it]Best trial: 11. Best value: 2.27402:  40%|████      | 20/50 [08:24<12:39, 25.30s/it]Best trial: 11. Best value: 2.27402:  42%|████▏     | 21/50 [08:24<14:12, 29.41s/it]                                                                                    [I 2026-01-10 16:56:05,698] Trial 0 finished with value: 2.637508242218583 and parameters: {'lr': 5.6115164153345e-05, 'dropout': 0.2852142919229748, 'weight_decay': 0.000291063591313307, 'n_layers': 9, 'latent_size': 1024, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 3000, 'grad_clip': 1.097037220101252}. Best is trial 0 with value: 2.637508242218583.
[I 2026-01-10 16:56:17,291] Trial 1 finished with value: 3.8768676349094937 and parameters: {'lr': 7.309539835912905e-05, 'dropout': 0.08736874205941257, 'weight_decay': 0.00016738085788752134, 'n_layers': 5, 'latent_size': 1024, 'embedding_dim': 768, 'batch_size': 128, 'warmup_steps': 8000, 'grad_clip': 1.6359549614212763}. Best is trial 0 with value: 2.637508242218583.
[I 2026-01-10 16:56:28,761] Trial 2 finished with value: 4.049112285886492 and parameters: {'lr': 4.066563313514796e-05, 'dropout': 0.029301634201915158, 'weight_decay': 0.000233596350262616, 'n_layers': 7, 'latent_size': 1024, 'embedding_dim': 512, 'batch_size': 64, 'warmup_steps': 8000, 'grad_clip': 1.8001719658125328}. Best is trial 0 with value: 2.637508242218583.
[I 2026-01-10 16:56:34,300] Trial 3 finished with value: 4.0861110006059915 and parameters: {'lr': 0.0001569639638866114, 'dropout': 0.27656227050693505, 'weight_decay': 1.5030900645056805e-05, 'n_layers': 5, 'latent_size': 768, 'embedding_dim': 256, 'batch_size': 128, 'warmup_steps': 7000, 'grad_clip': 0.4775597949149275}. Best is trial 0 with value: 2.637508242218583.
[I 2026-01-10 16:56:45,035] Trial 4 finished with value: 3.84121526990618 and parameters: {'lr': 1.0257563974185649e-05, 'dropout': 0.24463842853645024, 'weight_decay': 0.0002592475660475158, 'n_layers': 10, 'latent_size': 256, 'embedding_dim': 256, 'batch_size': 64, 'warmup_steps': 8000, 'grad_clip': 0.9972083578077036}. Best is trial 0 with value: 2.637508242218583.
[I 2026-01-10 16:57:12,948] Trial 5 finished with value: 3.814077172960554 and parameters: {'lr': 1.7345566642360933e-05, 'dropout': 0.21397343616689848, 'weight_decay': 0.0003323304206226791, 'n_layers': 9, 'latent_size': 256, 'embedding_dim': 1024, 'batch_size': 64, 'warmup_steps': 4000, 'grad_clip': 1.5355471632317925}. Best is trial 0 with value: 2.637508242218583.
[I 2026-01-10 16:57:24,764] Trial 6 finished with value: 3.0588503148820667 and parameters: {'lr': 2.8681134821030064e-05, 'dropout': 0.023093972948637898, 'weight_decay': 3.797544798678414e-05, 'n_layers': 5, 'latent_size': 256, 'embedding_dim': 768, 'batch_size': 32, 'warmup_steps': 2000, 'grad_clip': 0.911504798389887}. Best is trial 0 with value: 2.637508242218583.
[I 2026-01-10 16:57:33,111] Trial 7 finished with value: 2.7772985564337835 and parameters: {'lr': 0.0004325432427964555, 'dropout': 0.258219174976903, 'weight_decay': 1.0325337616482036e-05, 'n_layers': 8, 'latent_size': 256, 'embedding_dim': 256, 'batch_size': 32, 'warmup_steps': 4000, 'grad_clip': 0.6716687886518623}. Best is trial 0 with value: 2.637508242218583.
[I 2026-01-10 16:57:51,987] Trial 8 finished with value: 2.961547048003585 and parameters: {'lr': 3.712624179040528e-05, 'dropout': 0.011066084206359838, 'weight_decay': 0.0001656260589333595, 'n_layers': 8, 'latent_size': 768, 'embedding_dim': 768, 'batch_size': 32, 'warmup_steps': 3000, 'grad_clip': 1.301381078127801}. Best is trial 0 with value: 2.637508242218583.
[I 2026-01-10 16:58:03,862] Trial 9 finished with value: 3.668052996907915 and parameters: {'lr': 0.00018495216589727275, 'dropout': 0.16073240522242754, 'weight_decay': 1.5155823539597614e-05, 'n_layers': 11, 'latent_size': 1024, 'embedding_dim': 256, 'batch_size': 64, 'warmup_steps': 8000, 'grad_clip': 0.36128979387738713}. Best is trial 0 with value: 2.637508242218583.
[I 2026-01-10 16:58:42,721] Trial 10 finished with value: 2.3077211689066 and parameters: {'lr': 0.000776735381623706, 'dropout': 0.1676552694772402, 'weight_decay': 0.0008691089486124979, 'n_layers': 12, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.291078925322479}. Best is trial 10 with value: 2.3077211689066.
[I 2026-01-10 16:59:21,591] Trial 11 finished with value: 2.274016914544282 and parameters: {'lr': 0.0009808126266739308, 'dropout': 0.18184389629895298, 'weight_decay': 0.0008589569128923666, 'n_layers': 12, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.2812360187852758}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:00:00,486] Trial 12 finished with value: 2.3233121545226485 and parameters: {'lr': 0.0008590989192880705, 'dropout': 0.1656078720226557, 'weight_decay': 0.00092396795676189, 'n_layers': 12, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.3210166590158243}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:00:39,365] Trial 13 finished with value: 2.3066421967965587 and parameters: {'lr': 0.0009818226878189125, 'dropout': 0.11228106731041984, 'weight_decay': 0.0009789295036197279, 'n_layers': 12, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.988730702333072}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:01:15,023] Trial 14 finished with value: 2.5091485623960144 and parameters: {'lr': 0.0003722241798943444, 'dropout': 0.09414204450743881, 'weight_decay': 0.0005395066939232556, 'n_layers': 11, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 6000, 'grad_clip': 1.843897663691383}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:01:33,403] Trial 15 finished with value: 2.4284133028101036 and parameters: {'lr': 0.0004832034110485126, 'dropout': 0.12177890389898519, 'weight_decay': 7.203342330140873e-05, 'n_layers': 12, 'latent_size': 512, 'embedding_dim': 512, 'batch_size': 16, 'warmup_steps': 2000, 'grad_clip': 1.9568062846306482}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:02:05,865] Trial 16 finished with value: 2.4605184925927057 and parameters: {'lr': 0.00022554823607104854, 'dropout': 0.19617389267938318, 'weight_decay': 0.0005498242173326432, 'n_layers': 10, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 0.1250405073237546}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:02:41,518] Trial 17 finished with value: 2.419449775307267 and parameters: {'lr': 0.0009550649181790387, 'dropout': 0.06670390707033828, 'weight_decay': 7.756193022802541e-05, 'n_layers': 11, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 5000, 'grad_clip': 1.5559875387691973}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:03:04,343] Trial 18 finished with value: 2.4479166490060313 and parameters: {'lr': 0.0003018175408954378, 'dropout': 0.1199027976442648, 'weight_decay': 0.0004890079184134741, 'n_layers': 7, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 2000, 'grad_clip': 0.7633031548023145}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:03:20,773] Trial 19 finished with value: 3.765783888953073 and parameters: {'lr': 0.00011112681934410147, 'dropout': 0.21500638892373308, 'weight_decay': 0.0007509505723795386, 'n_layers': 10, 'latent_size': 512, 'embedding_dim': 512, 'batch_size': 128, 'warmup_steps': 3000, 'grad_clip': 1.9740990318849945}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:03:59,745] Trial 20 finished with value: 2.469159413267065 and parameters: {'lr': 0.000567180263804391, 'dropout': 0.12825917562094857, 'weight_decay': 4.680015058133952e-05, 'n_layers': 12, 'latent_size': 768, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 5000, 'grad_clip': 1.1601029045555578}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:04:38,632] Trial 21 finished with value: 2.3177330273169057 and parameters: {'lr': 0.0007713573992325204, 'dropout': 0.18878023546431041, 'weight_decay': 0.0007957758037475159, 'n_layers': 12, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.3160540652418784}. Best is trial 11 with value: 2.274016914544282.Best trial: 11. Best value: 2.27402:  42%|████▏     | 21/50 [09:03<14:12, 29.41s/it]Best trial: 11. Best value: 2.27402:  42%|████▏     | 21/50 [09:03<14:12, 29.41s/it]Best trial: 11. Best value: 2.27402:  44%|████▍     | 22/50 [09:03<15:03, 32.25s/it]                                                                                    Best trial: 11. Best value: 2.27402:  44%|████▍     | 22/50 [09:38<15:03, 32.25s/it]Best trial: 11. Best value: 2.27402:  44%|████▍     | 22/50 [09:38<15:03, 32.25s/it]Best trial: 11. Best value: 2.27402:  46%|████▌     | 23/50 [09:38<14:58, 33.28s/it]                                                                                    Best trial: 11. Best value: 2.27402:  46%|████▌     | 23/50 [10:17<14:58, 33.28s/it]Best trial: 11. Best value: 2.27402:  46%|████▌     | 23/50 [10:17<14:58, 33.28s/it]Best trial: 11. Best value: 2.27402:  48%|████▊     | 24/50 [10:17<15:09, 34.97s/it]                                                                                    Best trial: 11. Best value: 2.27402:  48%|████▊     | 24/50 [10:53<15:09, 34.97s/it]Best trial: 11. Best value: 2.27402:  48%|████▊     | 24/50 [10:53<15:09, 34.97s/it]Best trial: 11. Best value: 2.27402:  50%|█████     | 25/50 [10:53<14:39, 35.18s/it]                                                                                    Best trial: 11. Best value: 2.27402:  50%|█████     | 25/50 [11:29<14:39, 35.18s/it]Best trial: 11. Best value: 2.27402:  50%|█████     | 25/50 [11:29<14:39, 35.18s/it]Best trial: 11. Best value: 2.27402:  52%|█████▏    | 26/50 [11:29<14:07, 35.33s/it]                                                                                    Best trial: 11. Best value: 2.27402:  52%|█████▏    | 26/50 [12:01<14:07, 35.33s/it]Best trial: 11. Best value: 2.27402:  52%|█████▏    | 26/50 [12:01<14:07, 35.33s/it]Best trial: 11. Best value: 2.27402:  54%|█████▍    | 27/50 [12:01<13:12, 34.47s/it]                                                                                    Best trial: 11. Best value: 2.27402:  54%|█████▍    | 27/50 [12:22<13:12, 34.47s/it]Best trial: 11. Best value: 2.27402:  54%|█████▍    | 27/50 [12:22<13:12, 34.47s/it]Best trial: 11. Best value: 2.27402:  56%|█████▌    | 28/50 [12:22<11:06, 30.31s/it]                                                                                    Best trial: 11. Best value: 2.27402:  56%|█████▌    | 28/50 [12:28<11:06, 30.31s/it]Best trial: 11. Best value: 2.27402:  56%|█████▌    | 28/50 [12:28<11:06, 30.31s/it]Best trial: 11. Best value: 2.27402:  58%|█████▊    | 29/50 [12:28<08:07, 23.20s/it]                                                                                    Best trial: 11. Best value: 2.27402:  58%|█████▊    | 29/50 [13:04<08:07, 23.20s/it]Best trial: 11. Best value: 2.27402:  58%|█████▊    | 29/50 [13:04<08:07, 23.20s/it]Best trial: 11. Best value: 2.27402:  60%|██████    | 30/50 [13:04<08:59, 26.99s/it]                                                                                    Best trial: 11. Best value: 2.27402:  60%|██████    | 30/50 [13:33<08:59, 26.99s/it]Best trial: 11. Best value: 2.27402:  60%|██████    | 30/50 [13:33<08:59, 26.99s/it]Best trial: 11. Best value: 2.27402:  62%|██████▏   | 31/50 [13:33<08:45, 27.66s/it]                                                                                    Best trial: 11. Best value: 2.27402:  62%|██████▏   | 31/50 [14:12<08:45, 27.66s/it]Best trial: 11. Best value: 2.27402:  62%|██████▏   | 31/50 [14:12<08:45, 27.66s/it]Best trial: 11. Best value: 2.27402:  64%|██████▍   | 32/50 [14:12<09:18, 31.04s/it]                                                                                    Best trial: 11. Best value: 2.27402:  64%|██████▍   | 32/50 [14:51<09:18, 31.04s/it]Best trial: 11. Best value: 2.27402:  64%|██████▍   | 32/50 [14:51<09:18, 31.04s/it]Best trial: 11. Best value: 2.27402:  66%|██████▌   | 33/50 [14:51<09:27, 33.39s/it]                                                                                    Best trial: 11. Best value: 2.27402:  66%|██████▌   | 33/50 [15:27<09:27, 33.39s/it]Best trial: 11. Best value: 2.27402:  66%|██████▌   | 33/50 [15:27<09:27, 33.39s/it]Best trial: 11. Best value: 2.27402:  68%|██████▊   | 34/50 [15:27<09:05, 34.08s/it]                                                                                    Best trial: 11. Best value: 2.27402:  68%|██████▊   | 34/50 [16:03<09:05, 34.08s/it]Best trial: 11. Best value: 2.27402:  68%|██████▊   | 34/50 [16:03<09:05, 34.08s/it]Best trial: 11. Best value: 2.27402:  70%|███████   | 35/50 [16:03<08:40, 34.70s/it]                                                                                    Best trial: 11. Best value: 2.27402:  70%|███████   | 35/50 [16:26<08:40, 34.70s/it]Best trial: 11. Best value: 2.27402:  70%|███████   | 35/50 [16:26<08:40, 34.70s/it]Best trial: 11. Best value: 2.27402:  72%|███████▏  | 36/50 [16:26<07:15, 31.10s/it]                                                                                    Best trial: 11. Best value: 2.27402:  72%|███████▏  | 36/50 [16:38<07:15, 31.10s/it]Best trial: 11. Best value: 2.27402:  72%|███████▏  | 36/50 [16:38<07:15, 31.10s/it]Best trial: 11. Best value: 2.27402:  74%|███████▍  | 37/50 [16:38<05:29, 25.32s/it]                                                                                    Best trial: 11. Best value: 2.27402:  74%|███████▍  | 37/50 [16:47<05:29, 25.32s/it]Best trial: 11. Best value: 2.27402:  74%|███████▍  | 37/50 [16:47<05:29, 25.32s/it]Best trial: 11. Best value: 2.27402:  76%|███████▌  | 38/50 [16:47<04:06, 20.52s/it]                                                                                    Best trial: 11. Best value: 2.27402:  76%|███████▌  | 38/50 [17:24<04:06, 20.52s/it]Best trial: 11. Best value: 2.27402:  76%|███████▌  | 38/50 [17:24<04:06, 20.52s/it]Best trial: 11. Best value: 2.27402:  78%|███████▊  | 39/50 [17:24<04:40, 25.53s/it]                                                                                    Best trial: 11. Best value: 2.27402:  78%|███████▊  | 39/50 [17:56<04:40, 25.53s/it]Best trial: 11. Best value: 2.27402:  78%|███████▊  | 39/50 [17:56<04:40, 25.53s/it]Best trial: 11. Best value: 2.27402:  80%|████████  | 40/50 [17:56<04:34, 27.46s/it]                                                                                    Best trial: 11. Best value: 2.27402:  80%|████████  | 40/50 [18:06<04:34, 27.46s/it]Best trial: 11. Best value: 2.27402:  80%|████████  | 40/50 [18:06<04:34, 27.46s/it]Best trial: 11. Best value: 2.27402:  82%|████████▏ | 41/50 [18:06<03:19, 22.18s/it]                                                                                    Best trial: 11. Best value: 2.27402:  82%|████████▏ | 41/50 [18:45<03:19, 22.18s/it]Best trial: 11. Best value: 2.27402:  82%|████████▏ | 41/50 [18:45<03:19, 22.18s/it]Best trial: 11. Best value: 2.27402:  84%|████████▍ | 42/50 [18:45<03:37, 27.19s/it]                                                                                    Best trial: 11. Best value: 2.27402:  84%|████████▍ | 42/50 [19:24<03:37, 27.19s/it]Best trial: 11. Best value: 2.27402:  84%|████████▍ | 42/50 [19:24<03:37, 27.19s/it]Best trial: 11. Best value: 2.27402:  86%|████████▌ | 43/50 [19:24<03:34, 30.70s/it]                                                                                    
[I 2026-01-10 17:05:14,305] Trial 22 finished with value: 2.331993756470857 and parameters: {'lr': 0.0006201378175827786, 'dropout': 0.14889116077310988, 'weight_decay': 0.000998421178882141, 'n_layers': 11, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.4291307271109934}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:05:53,208] Trial 23 finished with value: 2.4356598324245877 and parameters: {'lr': 0.0002912482919048389, 'dropout': 0.06050300502270102, 'weight_decay': 0.00042387906925218244, 'n_layers': 12, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 2000, 'grad_clip': 1.7329949507054803}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:06:28,889] Trial 24 finished with value: 2.2872845375979387 and parameters: {'lr': 0.0009603327229740442, 'dropout': 0.18152138731408413, 'weight_decay': 0.0006074962813762092, 'n_layers': 11, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 0.8240542068038763}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:07:04,554] Trial 25 finished with value: 2.37978548473782 and parameters: {'lr': 0.0009983118791041822, 'dropout': 0.22066403876937307, 'weight_decay': 0.0006098645702129296, 'n_layers': 11, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 2000, 'grad_clip': 0.8294547471267301}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:07:37,022] Trial 26 finished with value: 2.4287250174416437 and parameters: {'lr': 0.0005656460122042262, 'dropout': 0.13819155390990845, 'weight_decay': 0.0003543178739203125, 'n_layers': 10, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 3000, 'grad_clip': 0.5743488250624522}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:07:57,623] Trial 27 finished with value: 2.7938766479492188 and parameters: {'lr': 0.00037110180357524664, 'dropout': 0.18887551729366897, 'weight_decay': 0.00016451677532375162, 'n_layers': 9, 'latent_size': 512, 'embedding_dim': 768, 'batch_size': 128, 'warmup_steps': 1000, 'grad_clip': 0.35684739174663627}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:08:04,246] Trial 28 finished with value: 2.7171882346824363 and parameters: {'lr': 0.00011764508642089965, 'dropout': 0.10299326717953255, 'weight_decay': 0.0007284350771180004, 'n_layers': 4, 'latent_size': 768, 'embedding_dim': 512, 'batch_size': 32, 'warmup_steps': 2000, 'grad_clip': 1.0056057585333014}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:08:40,070] Trial 29 finished with value: 2.404836588435703 and parameters: {'lr': 0.000671357112404437, 'dropout': 0.23832956598566632, 'weight_decay': 0.0004241082211470006, 'n_layers': 11, 'latent_size': 1024, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 4000, 'grad_clip': 1.1239830564348328}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:09:09,311] Trial 30 finished with value: 2.4804832537968955 and parameters: {'lr': 0.00025744500871826355, 'dropout': 0.1791699910673188, 'weight_decay': 0.0002228431762325656, 'n_layers': 9, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 3000, 'grad_clip': 1.176891656583595}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:09:48,213] Trial 31 finished with value: 2.310802424395526 and parameters: {'lr': 0.0007530161363073768, 'dropout': 0.16431432035387009, 'weight_decay': 0.0009563026305294917, 'n_layers': 12, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 0.8945522514345344}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:10:27,107] Trial 32 finished with value: 2.276102096946151 and parameters: {'lr': 0.000989140951540309, 'dropout': 0.14478123814972943, 'weight_decay': 0.0006343935319040348, 'n_layers': 12, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.6582611599594383}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:11:02,773] Trial 33 finished with value: 2.3241919720614397 and parameters: {'lr': 0.000976822038290083, 'dropout': 0.07437475174788306, 'weight_decay': 0.0006770324022478834, 'n_layers': 11, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 2000, 'grad_clip': 1.675476502503268}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:11:38,937] Trial 34 finished with value: 2.7135021005358015 and parameters: {'lr': 0.0004243343538188744, 'dropout': 0.2979716059159515, 'weight_decay': 0.00034671864030422694, 'n_layers': 12, 'latent_size': 1024, 'embedding_dim': 1024, 'batch_size': 128, 'warmup_steps': 1000, 'grad_clip': 1.8431524625349542}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:12:01,636] Trial 35 finished with value: 2.388707253668043 and parameters: {'lr': 0.0005728767337386561, 'dropout': 0.11164883116500393, 'weight_decay': 0.0006523785181620789, 'n_layers': 10, 'latent_size': 512, 'embedding_dim': 768, 'batch_size': 16, 'warmup_steps': 2000, 'grad_clip': 1.7408991657565414}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:12:13,465] Trial 36 finished with value: 3.3213822160448347 and parameters: {'lr': 6.810258967421467e-05, 'dropout': 0.13919966130712458, 'weight_decay': 0.0002878556030203547, 'n_layers': 11, 'latent_size': 512, 'embedding_dim': 256, 'batch_size': 64, 'warmup_steps': 1000, 'grad_clip': 1.4865215347687777}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:12:22,790] Trial 37 finished with value: 2.4675085500434593 and parameters: {'lr': 0.0006917201271733563, 'dropout': 0.05170481456638075, 'weight_decay': 0.00019913187624785676, 'n_layers': 6, 'latent_size': 256, 'embedding_dim': 512, 'batch_size': 16, 'warmup_steps': 3000, 'grad_clip': 1.6089486812757616}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:13:00,008] Trial 38 finished with value: 2.592870831489563 and parameters: {'lr': 0.0004839192258644643, 'dropout': 0.20194099053545753, 'weight_decay': 0.0004429091495043791, 'n_layers': 12, 'latent_size': 768, 'embedding_dim': 1024, 'batch_size': 64, 'warmup_steps': 1000, 'grad_clip': 1.9346330578734456}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:13:31,981] Trial 39 finished with value: 2.8978383717713534 and parameters: {'lr': 1.8077740176281215e-05, 'dropout': 0.08299141435713978, 'weight_decay': 0.00012057876072878817, 'n_layers': 10, 'latent_size': 1024, 'embedding_dim': 1024, 'batch_size': 32, 'warmup_steps': 2000, 'grad_clip': 1.4243862238929528}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:13:41,826] Trial 40 finished with value: 3.8750954355512346 and parameters: {'lr': 0.00015244270430623858, 'dropout': 0.14951302260051502, 'weight_decay': 2.6640543730841014e-05, 'n_layers': 9, 'latent_size': 256, 'embedding_dim': 256, 'batch_size': 128, 'warmup_steps': 7000, 'grad_clip': 0.7038425422248963}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:14:20,706] Trial 41 finished with value: 2.319300965026573 and parameters: {'lr': 0.0008108706612015682, 'dropout': 0.165161089611075, 'weight_decay': 0.0008141513953679078, 'n_layers': 12, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.2676741312842346}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:14:59,586] Trial 42 finished with value: 2.3202666927267006 and parameters: {'lr': 0.0007470057068135403, 'dropout': 0.2269360203022082, 'weight_decay': 0.0009977320494992386, 'n_layers': 12, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.010710797514529}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:15:35,256] Trial 43 finished with value: 2.2972541208620423 and parameters: {'lr': 0.0009136908159370085, 'dropout': 0.17312339444121116, 'weight_decay': 0.0006020503039959345, 'n_layers': 11, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.2272336007656217}. Best is trial 11 with value: 2.274016914544282.Best trial: 11. Best value: 2.27402:  86%|████████▌ | 43/50 [19:59<03:34, 30.70s/it]Best trial: 11. Best value: 2.27402:  86%|████████▌ | 43/50 [19:59<03:34, 30.70s/it]Best trial: 11. Best value: 2.27402:  88%|████████▊ | 44/50 [19:59<03:13, 32.19s/it]                                                                                    Best trial: 11. Best value: 2.27402:  88%|████████▊ | 44/50 [20:24<03:13, 32.19s/it]Best trial: 11. Best value: 2.27402:  88%|████████▊ | 44/50 [20:24<03:13, 32.19s/it]Best trial: 11. Best value: 2.27402:  90%|█████████ | 45/50 [20:24<02:30, 30.01s/it]                                                                                    Best trial: 11. Best value: 2.27402:  90%|█████████ | 45/50 [21:00<02:30, 30.01s/it]Best trial: 11. Best value: 2.27402:  90%|█████████ | 45/50 [21:00<02:30, 30.01s/it]Best trial: 11. Best value: 2.27402:  92%|█████████▏| 46/50 [21:00<02:06, 31.71s/it]                                                                                    Best trial: 11. Best value: 2.27402:  92%|█████████▏| 46/50 [21:31<02:06, 31.71s/it]Best trial: 11. Best value: 2.27402:  92%|█████████▏| 46/50 [21:31<02:06, 31.71s/it]Best trial: 11. Best value: 2.27402:  94%|█████████▍| 47/50 [21:31<01:34, 31.49s/it]                                                                                    Best trial: 11. Best value: 2.27402:  94%|█████████▍| 47/50 [21:39<01:34, 31.49s/it]Best trial: 11. Best value: 2.27402:  94%|█████████▍| 47/50 [21:39<01:34, 31.49s/it]Best trial: 11. Best value: 2.27402:  96%|█████████▌| 48/50 [21:39<00:49, 24.52s/it]                                                                                    Best trial: 11. Best value: 2.27402:  96%|█████████▌| 48/50 [21:47<00:49, 24.52s/it]Best trial: 11. Best value: 2.27402:  96%|█████████▌| 48/50 [21:47<00:49, 24.52s/it]Best trial: 11. Best value: 2.27402:  98%|█████████▊| 49/50 [21:47<00:19, 19.36s/it]                                                                                    Best trial: 11. Best value: 2.27402:  98%|█████████▊| 49/50 [21:53<00:19, 19.36s/it]Best trial: 11. Best value: 2.27402:  98%|█████████▊| 49/50 [21:53<00:19, 19.36s/it]Best trial: 11. Best value: 2.27402: 100%|██████████| 50/50 [21:53<00:00, 15.60s/it]Best trial: 11. Best value: 2.27402: 100%|██████████| 50/50 [21:53<00:00, 26.28s/it]

[I 2026-01-10 17:16:00,198] Trial 44 finished with value: 2.3682093885209827 and parameters: {'lr': 0.0009747006558868188, 'dropout': 0.1786941670887043, 'weight_decay': 0.0005664977718060527, 'n_layers': 11, 'latent_size': 512, 'embedding_dim': 768, 'batch_size': 16, 'warmup_steps': 2000, 'grad_clip': 0.8977657847461123}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:16:35,854] Trial 45 finished with value: 2.335640041916459 and parameters: {'lr': 0.0005244394588139693, 'dropout': 0.13768229277977495, 'weight_decay': 0.000354904488119986, 'n_layers': 11, 'latent_size': 512, 'embedding_dim': 1024, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.07654156626478}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:17:06,853] Trial 46 finished with value: 2.6912885223116194 and parameters: {'lr': 0.00034789388646408513, 'dropout': 0.2673402711721795, 'weight_decay': 0.0005150217166138319, 'n_layers': 10, 'latent_size': 256, 'embedding_dim': 1024, 'batch_size': 64, 'warmup_steps': 2000, 'grad_clip': 1.4021982730753422}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:17:15,088] Trial 47 finished with value: 2.3007981468130043 and parameters: {'lr': 0.0006536940520159158, 'dropout': 0.20458270459085753, 'weight_decay': 0.0006352796602174763, 'n_layers': 7, 'latent_size': 512, 'embedding_dim': 256, 'batch_size': 16, 'warmup_steps': 1000, 'grad_clip': 1.214587325821239}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:17:22,427] Trial 48 finished with value: 2.4579719260886863 and parameters: {'lr': 0.0006416881287506044, 'dropout': 0.2054790849360454, 'weight_decay': 0.0002935353803197151, 'n_layers': 7, 'latent_size': 512, 'embedding_dim': 256, 'batch_size': 32, 'warmup_steps': 1000, 'grad_clip': 1.218869544339014}. Best is trial 11 with value: 2.274016914544282.
[I 2026-01-10 17:17:29,234] Trial 49 finished with value: 2.4318651446589716 and parameters: {'lr': 0.000432226222997237, 'dropout': 0.24266956436728573, 'weight_decay': 0.00041020996316624763, 'n_layers': 6, 'latent_size': 768, 'embedding_dim': 256, 'batch_size': 16, 'warmup_steps': 2000, 'grad_clip': 1.0991607597999007}. Best is trial 11 with value: 2.274016914544282.

======================================================================
OPTIMIZATION COMPLETE
======================================================================
Number of finished trials: 50
Number of pruned trials: 0
Number of complete trials: 50

Best trial:
  Value (val_loss): 2.2740
  Params:
    lr: 0.0009808126266739308
    dropout: 0.18184389629895298
    weight_decay: 0.0008589569128923666
    n_layers: 12
    latent_size: 512
    embedding_dim: 1024
    batch_size: 16
    warmup_steps: 1000
    grad_clip: 1.2812360187852758

Saved best hyperparameters to checkpoints/hyperparameter_search/best_hyperparameters.json
Saved parameter importance plot to checkpoints/hyperparameter_search/param_importance.html
Saved optimization history to checkpoints/hyperparameter_search/optimization_history.html

======================================================================
RECOMMENDATION:
======================================================================
Now train with best hyperparameters using:
  python pretrain_encoder.py --data_dir data/chembl/tokenized \
    --lr 0.0009808126266739308 \
    --dropout 0.18184389629895298 \
    --weight_decay 0.0008589569128923666 \
    --n_layers 12 \
    --latent_size 512 \
    --embedding_dim 1024 \
    --batch_size 16 \
    --warmup_steps 1000 \
    --grad_clip 1.2812360187852758 \
    --epochs 10
======================================================================

